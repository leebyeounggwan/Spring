
# ğŸ“– ì‹¤ìŠµ í™˜ê²½
* spring boot 2.7.4
* java 11
* ehcache 2.x
* mysql 8.0.33
* Maven
* intellij

---

# Cahcing

### 1. Cahcing ì ìš© ì „í›„ ì„±ëŠ¥ ë¹„êµ
- TTL : 20 sec
- `GET /api/v1/boards/1`
=======
### Cahcing ì ìš© ì „í›„ ì„±ëŠ¥ ë¹„êµ _ Ngrinder
- *TTL : 20 sec
- `GET /api/notices`

- Vuser : 1
- Duration : 60 sec

<br>

#### *ìºì‹± ì ìš© ì „*
![before_cached.png](src%2Fmain%2Fresources%2Fimages%2Fbefore_cached.png)

#### *ìºì‹± ì ìš© í›„*
![after_cached.png](src%2Fmain%2Fresources%2Fimages%2Fafter_cached.png)

<br>

### ìˆ˜ì¹˜ë³€í™”
- *ìºì‹± ì ìš© ì „*
  - í‰ê·  TPS : 12 
  - Peek TPS : 14
  - Mean Test Time : 849 ms
  - Executed Tests : 649

  
- *ìºì‹± ì ìš© í›„*
  - í‰ê·  TPS : 251
  - Peek TPS : 284
  - Mean Test Time : 40 ms
  - Executed Tests : 13,652


> ìºì‹± ì ìš© í›„ TPS ë° ì‘ë‹µì‹œê°„, ì‹¤í–‰íšŸìˆ˜ê°€ ì¦ê°€í–ˆìœ¼ë©°, TTL(20ì´ˆ) ë§ˆë‹¤ ìºì‹œê°€ ì´ˆê¸°í™” ë˜ëŠ” ê²ƒì„ ê·¸ë˜í”„ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<br>

---

### 2. ê³µì§€ì‚¬í•­ í˜ì´ì§€ë¥¼ ì¡°íšŒí•œë‹¤ê³  ê°€ì •(1page ~ 10page ê¹Œì§€ ëœë¤ í˜¸ì¶œ)
<br>

#### Ngrinder groovy script code

```Groovy
@Test
public void test() {
  // ëœë¤í•œ í˜ì´ì§€ ê°’ ìƒì„± (1 ì´ìƒ, 10 ì´í•˜)
  def randomPage = new Random().nextInt(10) + 1

  // API í˜¸ì¶œ URL ì¡°í•©
  def apiUrl = "http://127.0.0.1:8080/api/notices/${randomPage}"

  // API í˜¸ì¶œ ë° ì‘ë‹µ íšë“
  HTTPResponse response = request.GET(apiUrl, params)

  if (response.statusCode == 301 || response.statusCode == 302) {
    grinder.logger.warn("Warning. The response may not be correct. The response code was {}.", response.statusCode)
  } else {
    assertThat(response.statusCode, is(200))
  }
}


```


- `GET /api/notices/{pageNuumber}`
- Vuser : 1
- Duration : 60 sec


#### *ìºì‹± ì ìš© ì „*
![page_before.png](src%2Fmain%2Fresources%2Fimages%2Fpage_before.png)

#### *ìºì‹± ì ìš© í›„*
![page_after.png](src%2Fmain%2Fresources%2Fimages%2Fpage_after.png)

### ìˆ˜ì¹˜ë³€í™”
- *ìºì‹± ì ìš© ì „*
  - í‰ê·  TPS : 2051
  - Peek TPS : 2512
  - Mean Test Time : 4 ms
  - Executed Tests : 111,670

  
- *ìºì‹± ì ìš© í›„* (1~5í˜ì´ì§€ë§Œ ìºì‹± ì ìš©)
  - í‰ê·  TPS : 2848
  - Peek TPS : 3493
  - Mean Test Time : 3 ms
  - Executed Tests : 154,822

=======
<br>

ìºì‹±ì²˜ë¦¬ -> local cache / global cache
local cache -> ê°œë³„ ì„œë²„ ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš© -> ë©”ëª¨ë¦¬ ë‚´ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ í–¥ìƒ
global cache -> ì£¼ë¡œ redis, memcached ë“±ì„ ì‚¬ìš© -> ì—¬ëŸ¬ ì„œë²„ ê°„ì— ë°ì´í„°ë¥¼ ê³µìœ í•˜ê¸° ìœ„í•´ ì‚¬ìš©

-> ì‹¤ìŠµí•œ ê³µì§€ì‚¬í•­ ì²˜ëŸ¼ ìì£¼ ë³€í•˜ì§€ ì•Šê³  ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ ê³µìœ ê°€ í•„ìš” ì—†ëŠ” ë°ì´í„°ì˜ ê²½ìš°,
local cacheê°€ ì¢‹ì€ ì„ íƒì´ë¼ê³  ìƒê°í•˜ì§€ë§Œ ê°ê°ì˜ ì¥ë‹¨ì ì„ ì•Œê³  ìƒí™©ì— ë”°ë¼ ì ì ˆíˆ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•¨.

redisì™€ ê°™ì€ ìºì‹œì„œë²„ë¥¼ êµ¬ì¶•ì„ í•„ìš”ë¡œ í•˜ì§€ ì•Šê³ , ì˜ì¡´ì„± ì¶”ê°€ë§Œìœ¼ë¡œ ì‰½ê²Œ ì ìš©ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ë³„ë„ì˜ ë¦¬ì†ŒìŠ¤ê°€ í•„ìš”ì—†ë‹¤ëŠ” ì¥ì ë„ ìˆë‹¤.

ìºì‹œ ìš©ëŸ‰ì œí•œ ë„ë‹¬ ì‹œ ì–´ë–¤ ë°ì´í„°ë¥¼ ì‚­ì œí• ì§€? -> LRU, LFU, FIFO

LRU : ê°€ì¥ ì˜¤ë«ë™ì•ˆ ì°¸ì¡°ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ì‚­ì œ<br>
LFU : ì°¸ì¡° íšŸìˆ˜ê°€ ê°€ì¥ ì ì€ ë°ì´í„°ë¥¼ ì‚­ì œ<br>
FIFO : ê°€ì¥ ë¨¼ì € ì‚½ì…ëœ ë°ì´í„°ë¥¼ ì‚­ì œ

ê³µì§€ì‚¬í•­ì´ë”ë¼ë„ ìƒí™©ì— ë”°ë¼ ì–´ë–¤ í˜ì´ì§€ êµì²´ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í• ì§€ ë‹¬ë¼ì§ˆ ê²ƒ ê°™ìŒ.


### ë°ì´í„° ê°±ì‹  ì‹œ ì²˜ë¦¬ë°©ë²•
1. @CacheEvictë¥¼ í†µí•´ íŠ¹ì • ìƒí™©ì—ì„œ ìºì‹œë¥¼ ê°±ì‹ 
2. TTLì„ ì„¤ì •í•˜ì—¬ ì¼ì • ì‹œê°„ë§ˆë‹¤ ìºì‹œë¥¼ ê°±ì‹ 


### ìºì‹œë¥¼ ì–¸ì œ ì‚¬ìš©í•  ê²ƒì¸ì§€
ìºì‹œ ì ìš© ì‹œ ìºì‹œì— í•„ìš”í•œ ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸ í›„ ì—†ìœ¼ë©´ DBì—ì„œ ì¡°íšŒí•˜ê¸° ë•Œë¬¸ì—,
íˆíŠ¸ìœ¨ì´ ë–¨ì–´ì§€ëŠ” ë°ì´í„°ì¸ ê²½ìš° ìºì‹œ ë°ì´í„° ì¡°íšŒ + DB ì¡°íšŒ -> ì´ì¤‘ ì¡°íšŒê°€ ë°œìƒí•˜ì—¬ ì˜¤íˆë ¤ ì„±ëŠ¥ì´ ì €í•˜ ë  ìˆ˜ë„ ìˆìŒ

1. ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ë°ì´í„°
2. ì¡°íšŒê°€ ë§ì€ ë°ì´í„°
3. ì‹¤ì‹œê°„ ë°ì´í„°ê°€ ì¤‘ìš”í•˜ì§€ ì•Šì€ ê²½ìš°
ë“± ëª©ì , ìƒí™©, ìš”ì¸ì„ ê³ ë ¤í•˜ëŠ” ê±°ì´ ì¤‘ìš”



# Index
- Whereì ˆì˜ íŠ¹ì •ì»¬ëŸ¼ì„ ì¸ë±ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ë¹ ë¥¸ ê²€ìƒ‰ ê°€ëŠ¥
- Joinì ˆì—ì„œ ì¸ë±ìŠ¤ê°€ ìˆëŠ” ê²½ìš° ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ ì¡°ì¸ì„ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ í–¥ìƒ
- Order Byì ˆì—ì„œ ì¸ë±ìŠ¤ë¥¼ í†µí•´ ë¹ ë¥¸ ì •ë ¬ ê°€ëŠ¥
- ë²”ìœ„ ê²€ìƒ‰ ì‹œ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ë¹ ë¥´ê²Œ ê²€ìƒ‰ ê°€ëŠ¥

<br>

ì¸ë±ìŠ¤ ìƒì„± ê¸°ì¤€
1. ì¡°íšŒê°€ ë§ì€ ì»¬ëŸ¼
2. ë²”ìœ„ ê²€ìƒ‰ì´ë‚˜ ì •ë ¬ì´ í•„ìš”í•œ ì»¬ëŸ¼
3. ì¡°ì¸ì´ë‚˜ ì„œë¸Œì¿¼ë¦¬ì— ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼
4. ìœ ë‹ˆí¬í•œ ê°’ì´ë‚˜ ì™¸ë˜í‚¤ë¡œ ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼
5. ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ì»¬ëŸ¼

â€» ìƒí™©ì— ë”°ë¼ Full Scanì´ ë” ë¹ ë¥¼ ìˆ˜ë„ ìˆê³  ì˜µí‹°ë§ˆì´ì €ì— ë”°ë¼ ì‹¤í–‰ê³„íšì´ ë‹¬ë¼ì§€ë¯€ë¡œ,
 ì‹¤í–‰ê³„íšì„ í™•ì¸í•˜ê³  í•„ìš”ì‹œ Hintë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ë±ìŠ¤ë¥¼ ì ìš©
